# FBX Loader - Karma Enhanced
import sys
import os

# –ü—É—Ç—å –∫ –º–æ–¥—É–ª—è–º
user_dir = hou.homeHoudiniDirectory()
scripts_path = os.path.join(user_dir, "scripts", "python", "fbx_loader")

if scripts_path not in sys.path:
    sys.path.insert(0, scripts_path)

# –ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã
try:
    from shelf_tool_karma import main
    main()
except ImportError:
    # Fallback –Ω–∞ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—É—é —Å–∏—Å—Ç–µ–º—É
    try:
        from shelf_tool import main
        main()
    except ImportError:
        hou.ui.displayMessage("FBX Loader –º–æ–¥—É–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã!", severity=hou.severityType.Error)





___________________________________________________





# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –∏–º–ø–æ—Ä—Ç–∞
import hou

# –í—ã–±–∏—Ä–∞–µ–º –ø–∞–ø–∫—É —Å–Ω–æ–≤–∞
folder = hou.ui.selectFile(
    title="–í—ã–±–µ—Ä–∏—Ç–µ –ø–∞–ø–∫—É —Å FBX –º–æ–¥–µ–ª—è–º–∏", 
    file_type=hou.fileType.Directory
)

if folder:
    print(f"–í—ã–±—Ä–∞–Ω–∞ –ø–∞–ø–∫–∞: {folder}")
    
    # –ó–∞–ø—É—Å–∫–∞–µ–º –∏–º–ø–æ—Ä—Ç —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
    from main_karma_enhanced import import_models_with_karma_support
    
    result = import_models_with_karma_support(
        folder_path=folder,
        import_mode="separate",      # –æ—Ç–¥–µ–ª—å–Ω—ã–µ –º–æ–¥–µ–ª–∏
        material_type="materialx",   # MaterialX –¥–ª—è Karma
        target_render="karma",       # Karma —Ä–µ–Ω–¥–µ—Ä
        auto_detect_textures=True,
        use_udim_textures=True,
        validate_materials=True,
        optimize_for_render=True,
        debug_mode=True             # –≤–∫–ª—é—á–∞–µ–º –ø–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏
    )
    
    if result:
        print("üéâ –ò–º–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à–µ–Ω —É—Å–ø–µ—à–Ω–æ!")
        hou.ui.displayMessage("–ò–º–ø–æ—Ä—Ç –º–æ–¥–µ–ª–µ–π –∑–∞–≤–µ—Ä—à–µ–Ω —É—Å–ø–µ—à–Ω–æ!", severity=hou.severityType.Message)
    else:
        print("‚ùå –ò–º–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à–µ–Ω —Å –æ—à–∏–±–∫–∞–º–∏, –Ω–æ check viewport - –≤–æ–∑–º–æ–∂–Ω–æ –º–æ–¥–µ–ª–∏ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–ª–∏—Å—å")
else:
    print("–í—ã–±–æ—Ä –ø–∞–ø–∫–∏ –æ—Ç–º–µ–Ω–µ–Ω")